extends layout

block content
    script.
        function submitPost(name, comment) {
            const body = JSON.stringify({ comment });
            fetch(`/dogs/${name}/comment`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body,
            }).then((res) => {
                if (res.status === 200) {
                    location.reload();
                } else {
                    alert('There was an error submitting your comment.');
                }
            });

        }

    div.header
        li My Subreddits
        li r/jonluca
    div.main
        div.banner
            img(src='../images/background.jpg')
        div.title
            img(src='//b.thumbs.redditmedia.com/Sgqw1zW5DO9gHEOhJtVxS_hC7pIzOoRgokC-xqfUmWI.png')
            h1(onclick='window.location.href="/"') /r/dogs
        div.post-body
            div.vote-container
                img(src='../images/up-arrow.svg', onclick=`handleClick(this, "${dog.name}", "POST")`)
                p= dog.rating
                img(src='../images/down-arrow.svg', onclick=`handleClick(this, "${dog.name}", "DELETE")`)
            div.post-content
                img(src=dog.imageUrl)
        div.comment-section
            div.write-comment
                h1 all #{dog.comments.length} comments:
                p Reminder: everytime you write a vulgar comment a little puppy dies
                textarea(id='comment')
            button(onclick=`submitPost("${dog.name}", document.getElementById("comment").value)`) Save
            each comment in dog.comments
                div.comment
                    p= comment
